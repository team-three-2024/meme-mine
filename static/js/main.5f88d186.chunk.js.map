{"version":3,"sources":["components/CameraController.js","helpers/track.js","helpers/url.js","components/Canary.js","components/Credits.js","config.js","components/Lights.js","lib/GameOverScreen.js","components/HealthBar.js","components/Noise.js","helpers/clean.js","components/Obstacles.js","components/Path.js","lib/Game.js","lib/StartScreen.js","components/ProgressBar.js","lib/Flow.js","components/Models.js","components/Videos.js","index.js"],"names":["CameraController","_ref","mode","_useThree","useThree","camera","set","perspCamera","THREE","useEffect","position","useFrame","updateProjectionMatrix","playTrack","track","current","pause","currentTime","play","assetURL","path","concat","process","prefix","Canary","props","initialPosition","canJump","undefined","canMove","muted","_useState","useState","_useState2","Object","slicedToArray","setPosition","_useState3","_useState4","isJumping","setIsJumping","_useState5","_useState6","hasSwitchedTrack","setHasSwitchedTrack","audioTracks","jump","useRef","move","footstep1","footstep2","main","animation","speed","reversed","glb","models","find","item","userData","name","scene","animations","animationRef","meshRef","handleCanaryRef","Audio","values","forEach","audioTrack","load","removeAttribute","rotation","x","Math","PI","clip","action","clipAction","timeScale","loop","stopAllAction","handleKeyDown","event","key","prevPosition","preventDefault","window","addEventListener","removeEventListener","_","delta","update","time","duration","newY","max","react_default","a","createElement","ref","assign","object","Title","styled","h3","_templateObject","taggedTemplateLiteral","Credit","_templateObject2","OverlayContainer","div","_templateObject3","Credits","href","target","rel","canaryConfig","objectUrl","hop","idle","walk","nodeCoords","nodeSigns","nodeScale","nodeGroupScale","meshColorIndex","meshScale","debug","model","material","scale","metalness","roughness","opacity","color","gridPosition","cameraPosition","pointColorIndex","primary","hovered","active","pointLight","intensity","distance","bloom","kernelSize","luminanceThreshold","luminanceSmoothing","glitch","delay","strength","lights","front","left","right","brandPalette","ciano","magenta","white","black","Lights","config","groupL","groupR","lightL","lightR","lightF","state","t","clock","getElapsedTime","currentPosition","parseInt","random","sin","y","cos","z","useHelper","Fragment","GameOverScreen","score","handleKeyPress","location","reload","document","CameraController_CameraController","Lights_Lights","Canary_Canary","OrbitControls","minPolarAngle","maxPolarAngle","Html","fullscreen","GameOverScreen_OverlayContainer","GameOverScreen_Title","Subtitle","FinalScore","Credits_Credits","blinkAnimation","keyframes","GameOverScreen_templateObject","GameOverScreen_templateObject2","h2","GameOverScreen_templateObject3","h1","_templateObject4","_templateObject5","HealthBar","health","HealthBarContainer","Health","HealthBar_templateObject","HealthBar_templateObject2","Noise","React","forwardRef","size","noiseTexture","useLoader","positionX","positionY","positionZ","lookAt","args","width","height","map","transparent","cleanUp","objectsToRemove","traverse","push","remove","geometry","dispose","Obstacle","side","videos","handleObstacleRef","videoRef","textureRef","obstacleRef","video","floor","length","VideoTexture","isPlaying","needsUpdate","Obstacles","_ref2","canaryRef","setScore","hitPoints","setHitPoints","handleGameOver","obstacles","setObstacles","lastBonusToastId","setLastBonusToastId","lastDamageToastId","setLastDamageToastId","clockRef","elapsedTime","bonusRateRef","nearBonusDetected","collisionDetected","obstacleIdentifier","prevObstacles","obstacle","objectSpread","playerBox","Box3","setFromObject","bonusBox","center","getCenter","getSize","multiplyScalar","rotatedSize","scaledRotatedPlayerBox","setFromCenterAndSize","bonusCenter","bonusSize","bonusRotatedSize","scaledRotatedBonusBox","atLeastOneBonus","obstacleBox","intersectsBox","prevHitPoints","toast","dismiss","newToastId","error","icon","style","borderRadius","background","fontWeight","prevScore","success","min","filter","lastObstacle","lastPosition","obstacleGap","obstacleSide","newObstacle","id","Date","now","toConsumableArray","_ref3","Obstacles_Obstacle","SideSegment","PathSegment","Path","playerRef","segments","setSegments","gamePosition","setGamePosition","lastSegmentRef","prevSegments","segment","lastSegmentZ","newSegmentZ","slice","index","Game","setCanaryRef","isGameOver","setIsGameOver","_useState7","_useState8","isGlitching","setIsGlitching","_useState9","_useState10","setMode","_useState11","_useState12","glitchAudioTrack","initialDelay","timeoutId","setTimeout","glitchOut","prevMode","randomDelay","newMode","clearTimeout","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","next","Promise","all","faceapi","faceExpressionNet","loadFromUri","faceRecognitionNet","ssdMobilenetv1","tinyFaceDetector","mtcnn","faceLandmark68Net","faceLandmark68TinyNet","ageGenderNet","stop","apply","this","arguments","loadModels","isGlitchActive","gameRef","GameOverScreen_GameOverScreen","postprocessing_dist","dtSize","GlitchMode","SPORADIC","enableZoom","enableRotate","ScoreContainer","ScoreDisplay","HealthBar_HealthBar","Game_templateObject","Game_templateObject2","StartScreen","showStartScreen","setShowStartScreen","showSelectMode","setShowSelectedMode","videoWidth","captureVideo","setCaptureVideo","isTouchDevice","navigator","maxTouchPoints","handleTouch","type","handleGameMode","gameMode","mediaDevices","getUserMedia","then","stream","srcObject","catch","err","console","onPlay","setInterval","_callee2","detections","_context2","withFaceLandmarks","withFaceExpressions","sent","expressions","angry","dispatchEvent","KeyboardEvent","surprised","happy","role","aria-label","StartScreen_OverlayContainer","StartScreen_Title","StartScreen_Subtitle","ControllerOption","onClick","AnimatedSubtitle","Hint","Game_Game","StartScreen_templateObject","StartScreen_templateObject2","StartScreen_templateObject3","StartScreen_templateObject4","p","StartScreen_templateObject5","_templateObject6","_templateObject7","ProgressBar","progress","ProgressBarContainer","Progress","ProgressBar_templateObject","ProgressBar_templateObject2","Flow","_usePreloadedModels","numberOfModels","setModels","loadingProgress","setLoadingProgress","loader","GLTFLoader","cleanupFunctions","loadedModelsCount","modelObjects","modelObj","src","loaded","gltf","m","cleanup","usePreloadedModels","modelsLoadingProgress","_usePreloadedVideos","numberOfVideos","setVideos","selectedFilenames","allFilenames","i","randomIndex","videoElements","filename","videoObj","videoElement","preload","playbackRate","setAttribute","onCanPlayThrough","loadedVideosCount","v","usePreloadedVideos","videosLoadingProgress","Flow_OverlayContainer","Flow_Title","ProgressBar_ProgressBar","react","fallback","react_three_fiber_esm","shadows","dpr","fov","performance","onCreated","gl","handleContextLost","alert","canvas","domElement","Preload","StartScreen_StartScreen","Flow_templateObject","Flow_templateObject2","StyledApp","src_templateObject","App","dist","Flow_Flow","rootElement","getElementById","createRoot","render","src_App"],"mappings":"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","file":"static/js/main.5f88d186.chunk.js","sourcesContent":["import { useThree, useFrame } from '@react-three/fiber'\nimport { useEffect } from 'react'\nimport * as THREE from 'three'\n\nconst CameraController = ({ mode }) => {\n  const { camera, set } = useThree()\n  const perspCamera = new THREE.PerspectiveCamera(50, 16 / 9, 0.1, 1000)\n\n  useEffect(() => {\n    if (mode === 'over') {\n      perspCamera.position.set(3, 1, 0)\n      set({ camera: perspCamera })\n\n      return null\n    }\n\n    if (mode === '2D') {\n      perspCamera.position.set(-20, 0, 1)\n      set({ camera: perspCamera })\n    } else {\n      perspCamera.position.set(0, 0.8, -3)\n      set({ camera: perspCamera })\n    }\n  }, [mode])\n\n  useFrame(() => {\n    camera.updateProjectionMatrix()\n  })\n\n  return null\n}\n\nexport { CameraController }\n","const playTrack = track => {\n  if (track.current) {\n    track.current.pause()\n    track.current.currentTime = 0\n    track.current.play()\n  }\n}\n\nexport { playTrack }\n","function assetURL(path) {\n  const publicUrl = process.env.PUBLIC_URL\n\n  const isDevelopment = process.env.NODE_ENV === 'development'\n  const isRoot = publicUrl === '/'\n\n  const assetPrefix = isDevelopment || isRoot ? '' : process.env.PUBLIC_URL\n\n  return `${assetPrefix}/assets/${path}`\n}\n\nfunction prefix(path) {\n  const publicUrl = process.env.PUBLIC_URL\n\n  const isDevelopment = process.env.NODE_ENV === 'development'\n  const isRoot = publicUrl === '/'\n\n  const assetPrefix = isDevelopment || isRoot ? '' : process.env.PUBLIC_URL\n\n  return `${assetPrefix}/${path}`\n}\n\nexport { assetURL, prefix }\n","import { useFrame } from '@react-three/fiber'\nimport React, { useState, useRef, useEffect } from 'react'\nimport * as THREE from 'three'\nimport { playTrack } from '../helpers/track'\nimport { assetURL } from '../helpers/url'\n\nconst Canary = props => {\n  const initialPosition = props.position ? props.position : [0, 0, 0]\n  const canJump = props.canJump !== undefined ? props.canJump : true\n  const canMove = props.canMove !== undefined ? props.canMove : true\n  const muted = props.muted !== undefined ? props.muted : false\n\n  const [position, setPosition] = useState(initialPosition)\n  const [isJumping, setIsJumping] = useState(false)\n  const [hasSwitchedTrack, setHasSwitchedTrack] = useState(false)\n\n  const audioTracks = {\n    jump: useRef(null),\n    move: useRef(null),\n    footstep1: useRef(null),\n    footstep2: useRef(null),\n    main: useRef(null)\n  }\n\n  let animation = props.animation\n  let speed = props.speed\n  let reversed = props.reversed\n\n  if (props.animation === 'dead') {\n    animation = 'idle'\n    speed = 0\n    reversed = true\n  }\n\n  const glb = props.models.find(item => item.userData.name === animation)\n  const { scene, animations } = glb\n\n  const animationRef = useRef()\n  const meshRef = useRef()\n\n  useEffect(() => {\n    if (props.handleCanaryRef) {\n      props.handleCanaryRef(meshRef)\n    }\n  }, [meshRef])\n\n  useEffect(() => {\n    audioTracks.jump.current = new Audio(assetURL('audio/canary_jump.mp3'))\n    audioTracks.move.current = new Audio(assetURL('audio/canary_swooshleftandright.mp3'))\n    audioTracks.footstep1.current = new Audio(assetURL('audio/canary_footstep1.mp3'))\n    audioTracks.footstep2.current = new Audio(assetURL('audio/canary_footstep2.mp3'))\n    audioTracks.main.current = new Audio(assetURL('audio/canary_in_a_meme_mine.mp3'))\n\n    Object.values(audioTracks).forEach(audioTrack => {\n      if (audioTrack.current) {\n        audioTrack.current.load()\n      }\n    })\n    return () => {\n      Object.values(audioTracks).forEach(audioTrack => {\n        if (audioTrack.current) {\n          audioTrack.current.pause()\n          audioTrack.current.removeAttribute('src')\n          audioTrack.current.load()\n        }\n      })\n    }\n  }, [])\n\n  useEffect(() => {\n    if (meshRef.current && reversed) {\n      meshRef.current.rotation.x = Math.PI / 0.85\n    }\n  }, [])\n\n  useEffect(() => {\n    if (meshRef && meshRef.current) {\n      animationRef.current = new THREE.AnimationMixer(meshRef.current)\n    }\n  }, [animation, meshRef])\n\n  useEffect(() => {\n    if (animationRef.current && animations) {\n      animations.forEach(clip => {\n        const action = animationRef.current.clipAction(clip)\n        action.timeScale = speed\n        action.play()\n      })\n    }\n\n    // it means the game started\n    if (props.speed === 3) {\n      audioTracks.main.current.loop = true\n      playTrack(audioTracks.main)\n    }\n\n    return () => {\n      if (animationRef.current) {\n        animationRef.current.stopAllAction()\n        setHasSwitchedTrack(false)\n      }\n    }\n  }, [animations])\n\n  useEffect(() => {\n    if (muted) return\n\n    playTrack(audioTracks.move)\n  }, [muted, position[0]])\n\n  useEffect(() => {\n    const handleKeyDown = event => {\n      if (canMove) {\n        if (event.key === 'ArrowRight') {\n          setPosition(prevPosition => {\n            if (prevPosition[0] !== -1) return [prevPosition[0] - 1, prevPosition[1], prevPosition[2]]\n            else return prevPosition\n          })\n        } else if (event.key === 'ArrowLeft') {\n          setPosition(prevPosition => {\n            if (prevPosition[0] !== 1) return [prevPosition[0] + 1, prevPosition[1], prevPosition[2]]\n            else return prevPosition\n          })\n        }\n      }\n      if (canJump) {\n        if (event.key === 'ArrowUp' && !isJumping && position[1] === 0) {\n          setIsJumping(true)\n          playTrack(audioTracks.jump)\n        }\n      }\n      if (event.key === 'ArrowDown') {\n        event.preventDefault()\n      }\n    }\n\n    window.addEventListener('keydown', handleKeyDown)\n\n    return () => {\n      window.removeEventListener('keydown', handleKeyDown)\n    }\n  }, [canMove, canJump, position])\n\n  useFrame((_, delta) => {\n    if (animationRef.current) {\n      animationRef.current.update(delta)\n\n      if (props.animation === 'walk' && props.speed === 1) {\n        animations.forEach(clip => {\n          const action = animationRef.current.clipAction(clip)\n          action.timeScale = speed\n\n          if (action.time > clip.duration / 2 && !hasSwitchedTrack) {\n            playTrack(audioTracks.footstep2)\n            setHasSwitchedTrack(true)\n          } else if (action.time < clip.duration / 2 && hasSwitchedTrack) {\n            playTrack(audioTracks.footstep1)\n            setHasSwitchedTrack(false)\n          }\n        })\n      }\n    }\n\n    if (isJumping) {\n      // Simple jump animation: move up then down\n      setPosition(prevPosition => {\n        const newY = prevPosition[1] + delta * 10\n        // Check if the model has reached the peak of the jump\n        if (newY >= 2.5) {\n          setIsJumping(false) // Start falling\n        }\n        return [prevPosition[0], newY <= 0 ? 0 : newY, prevPosition[2]] // Reset Y position after jump\n      })\n    } else {\n      // Bring the model back down if it's in the air\n      setPosition(prevPosition => {\n        if (prevPosition[1] !== 0) return [prevPosition[0], Math.max(0, prevPosition[1] - delta * 10), prevPosition[2]]\n        else return prevPosition\n      })\n    }\n  })\n\n  return (\n    <mesh position={position} ref={meshRef}>\n      <primitive object={scene} {...props} />\n    </mesh>\n  )\n}\n\nexport { Canary }\n","import React from 'react'\nimport styled from 'styled-components'\n\nconst Title = styled.h3`\n  margin: 0;\n  color: #fff;\n  text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;\n`\n\nconst Credit = styled.a`\n  font-size: 14px;\n  color: #fff;\n  margin: 0;\n  text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;\n  text-decoration: none;\n\n  &:hover {\n    color: #e6007a;\n  }\n`\n\nconst OverlayContainer = styled.div`\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n  align-items: end;\n  padding: 50px;\n`\n\nconst Credits = () => (\n  <OverlayContainer>\n    <Title>powered by</Title>\n    <Credit href=\"https://anything.world/\" target=\"_blank\" rel=\"noopener noreferrer\">\n      anything world\n    </Credit>\n    <Credit href=\"https://kusama.network/\" target=\"_blank\" rel=\"noopener noreferrer\">\n      kusama network\n    </Credit>\n    <Credit href=\"https://github.com/justadudewhohacks/face-api.js\" target=\"_blank\" rel=\"noopener noreferrer\">\n      face api\n    </Credit>\n    <Credit href=\"https://giphy.com/\" target=\"_blank\" rel=\"noopener noreferrer\">\n      giphy\n    </Credit>\n  </OverlayContainer>\n)\n\nexport { Credits }\n","const canaryConfig = {\n  objectUrl: {\n    hop: 'canary_hop.glb',\n    idle: 'canary_idle.glb',\n    walk: 'canary_walk.glb'\n  },\n  nodeCoords: 'canary.geometry.attributes.position',\n  nodeSigns: [1, -1, -1],\n  nodeScale: 2.5,\n  nodeGroupScale: 0.02,\n  meshColorIndex: 'ciano',\n  meshScale: 1,\n  debug: false,\n  model: {\n    material: 'Default_OBJ',\n    scale: 0.02,\n    metalness: 0.2,\n    roughness: 2,\n    opacity: 1,\n    color: 'white'\n  },\n  gridPosition: [0, -0.52, 0.28],\n  cameraPosition: [-20, 0, 0],\n  pointColorIndex: {\n    primary: 'ciano',\n    hovered: 'magenta',\n    active: 'magenta'\n  },\n  pointLight: {\n    position: [0, 0, 0],\n    intensity: [2, 2, 2],\n    distance: 15,\n    color: ['ciano', 'magenta', 'magenta']\n  },\n  bloom: {\n    kernelSize: 1,\n    luminanceThreshold: 0.1,\n    luminanceSmoothing: 0.05,\n    intensity: 0.1\n  },\n  glitch: {\n    delay: [20, 30],\n    duration: [0.3, 0.5],\n    strength: [0.1, 0.3]\n  },\n  lights: {\n    front: {\n      color: 'ciano'\n    },\n    left: {\n      color: 'white'\n    },\n    right: {\n      color: 'magenta'\n    }\n  }\n}\n\nconst brandPalette = {\n  ciano: '#01ffff',\n  magenta: '#e6007a',\n  white: '#ffffff',\n  black: '#000000'\n}\n\nexport { brandPalette, canaryConfig }\n","/* eslint-disable react/no-unknown-property */\n/* eslint-disable react/prop-types */\nimport { useHelper } from '@react-three/drei'\nimport { useFrame } from '@react-three/fiber'\nimport React, { useRef } from 'react'\nimport * as THREE from 'three'\nimport { brandPalette } from '../config'\n\nconst Lights = ({ config }) => {\n  const groupL = useRef()\n  const groupR = useRef()\n  const front = useRef()\n  const lightL = useRef()\n  const lightR = useRef()\n  const lightF = useRef()\n\n  useFrame(state => {\n    const t = state.clock.getElapsedTime()\n\n    // storm effect\n    let currentPosition = 15\n    if (parseInt(t) % 4 === 1) {\n      currentPosition = (Math.random() * 15) | 0\n    }\n\n    groupL.current.position.x = (Math.sin(t) / 4) * currentPosition\n    groupL.current.position.y = (Math.cos(t) / 4) * currentPosition\n    groupL.current.position.z = (Math.cos(t) / 4) * currentPosition\n\n    groupR.current.position.x = (Math.cos(t) / 4) * 10\n    groupR.current.position.y = (Math.sin(t) / 4) * 10\n    groupR.current.position.z = (Math.sin(t) / 4) * 10\n\n    front.current.position.x = (Math.sin(t) / 4) * 10\n    front.current.position.y = (Math.cos(t) / 4) * 10\n    front.current.position.z = (Math.sin(t) / 4) * 10\n  })\n\n  if (config.debug === true) {\n    useHelper(lightL, THREE.PointLightHelper)\n    useHelper(lightR, THREE.PointLightHelper)\n    useHelper(lightF, THREE.PointLightHelper)\n  }\n\n  return (\n    <>\n      <group ref={groupL}>\n        <pointLight\n          ref={lightL}\n          color={brandPalette[config.pointLight.color[0]]}\n          position={config.pointLight.position}\n          distance={config.pointLight.distance}\n          intensity={config.pointLight.intensity[0]}\n        />\n      </group>\n      <group ref={groupR}>\n        <pointLight\n          ref={lightR}\n          color={brandPalette[config.pointLight.color[1]]}\n          position={config.pointLight.position}\n          distance={config.pointLight.distance}\n          intensity={config.pointLight.intensity[1]}\n        />\n      </group>\n      <group ref={front}>\n        <pointLight\n          ref={lightF}\n          color={brandPalette[config.pointLight.color[2]]}\n          position={config.pointLight.position}\n          distance={config.pointLight.distance}\n          intensity={config.pointLight.intensity[2]}\n        />\n      </group>\n    </>\n  )\n}\n\nexport { Lights }\n","import { Html, OrbitControls } from '@react-three/drei'\nimport React, { useEffect } from 'react'\nimport styled, { keyframes } from 'styled-components'\nimport { CameraController } from '../components/CameraController'\nimport { Canary } from '../components/Canary'\nimport { Credits } from '../components/Credits'\nimport { Lights } from '../components/Lights'\nimport { canaryConfig as config } from '../config'\n\nconst GameOverScreen = ({ score, models }) => {\n  const mode = 'over'\n\n  useEffect(() => {\n    const handleKeyPress = event => {\n      if (event.key === 'Enter') {\n        window.location.reload()\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyPress)\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyPress)\n    }\n  }, [])\n\n  return (\n    <>\n      <CameraController mode={mode} />\n\n      <Lights config={config} />\n\n      <Canary\n        animation=\"dead\"\n        canMove={false}\n        canJump={false}\n        position={[0, 0.2, 0]}\n        scale={config.model.scale}\n        models={models}\n      />\n\n      <OrbitControls minPolarAngle={Math.PI / 2.8} maxPolarAngle={Math.PI / 1.8} />\n\n      <Html fullscreen>\n        <OverlayContainer>\n          <Title>GAME OVER</Title>\n          <Subtitle>press enter to restart</Subtitle>\n          <FinalScore>final score: {score}</FinalScore>\n        </OverlayContainer>\n\n        <Credits />\n      </Html>\n    </>\n  )\n}\n\nconst blinkAnimation = keyframes`\n  0%, 100% { opacity: 1; }\n  50% { opacity: 0; }\n`\n\nconst OverlayContainer = styled.div`\n  position: absolute;\n  top: 25px;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`\n\nconst FinalScore = styled.h2`\n  color: #fff;\n  margin-top: 10px;\n  text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;\n`\n\nconst Title = styled.h1`\n  color: #fff;\n  text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;\n`\n\nconst Subtitle = styled.h2`\n  color: #fff;\n  margin-top: 125px;\n  text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;\n  animation: ${blinkAnimation} 1500ms linear infinite;\n`\n\nexport { GameOverScreen }\n","import React from 'react'\nimport styled from 'styled-components'\n\nconst HealthBar = ({ health }) => (\n  <HealthBarContainer>\n    <Health health={health} />\n  </HealthBarContainer>\n)\n\nconst HealthBarContainer = styled.div`\n  width: 25vw;\n  background-color: #ddd;\n  border: 2px solid #666;\n  border-radius: 5px;\n  overflow: hidden;\n`\n\nconst Health = styled.div`\n  height: 20px;\n  width: ${props => props.health}%;\n  background-color: ${props => (props.health < 50 ? 'red' : '#01ffff')};\n  transition: width 0.5s ease-in-out;\n`\n\nexport { HealthBar }\n","import { useFrame, useLoader, useThree } from '@react-three/fiber'\nimport React from 'react'\nimport * as THREE from 'three'\nimport { assetURL } from '../helpers/url'\n\nconst Noise = React.forwardRef(({ mode, opacity }, ref) => {\n  const { size, camera } = useThree()\n  const noiseTexture = useLoader(THREE.TextureLoader, assetURL('noise.png'))\n\n  useFrame(() => {\n    const positionX = mode === '2D' ? camera.position.x + 0.5 : camera.position.x\n    const positionY = camera.position.y\n    const positionZ = mode === '2D' ? camera.position.z : camera.position.z + 0.5\n\n    ref.current.position.set(positionX, positionY, positionZ)\n    ref.current.lookAt(camera.position)\n  })\n\n  return (\n    <mesh ref={ref}>\n      <planeBufferGeometry args={[size.width / 500, size.height / 500]} />\n      <meshBasicMaterial map={noiseTexture} transparent opacity={opacity} />\n    </mesh>\n  )\n})\n\nexport { Noise }\n","function cleanUp(scene) {\n  const objectsToRemove = []\n\n  scene.traverse(object => {\n    if (object.position.z <= -50) {\n      objectsToRemove.push(object)\n    }\n  })\n\n  objectsToRemove.forEach(object => {\n    scene.remove(object)\n\n    if (object.geometry) {\n      object.geometry.dispose()\n    }\n    if (object.material) {\n      object.material.dispose()\n    }\n  })\n}\n\nexport { cleanUp }\n","import { useFrame, useThree } from '@react-three/fiber'\nimport React, { useEffect, useState, useRef } from 'react'\nimport toast from 'react-hot-toast'\nimport * as THREE from 'three'\nimport { Box3, VideoTexture } from 'three'\nimport { cleanUp } from '../helpers/clean'\n\nconst random = (min, max) => Math.floor(Math.random() * (max - min)) + min\n\nconst Obstacle = ({ mode, positionZ, side, videos, handleObstacleRef }) => {\n  const videoRef = useRef()\n  const textureRef = useRef()\n  const obstacleRef = useRef()\n  const video = videos[Math.floor(Math.random() * videos.length)]\n\n  useEffect(() => {\n    videoRef.current = video\n    textureRef.current = new VideoTexture(video)\n  }, [])\n\n  useFrame(() => {\n    if (!video.isPlaying) {\n      video.play()\n    }\n  })\n\n  useEffect(() => {\n    handleObstacleRef(positionZ, obstacleRef)\n  }, [positionZ])\n\n  useEffect(() => {\n    if (obstacleRef.current) {\n      if (mode === '2D') {\n        obstacleRef.current.rotation.y = Math.PI / 2\n      } else {\n        obstacleRef.current.rotation.y = 0\n      }\n    }\n  }, [mode])\n\n  useFrame(() => {\n    if (textureRef.current) {\n      textureRef.current.needsUpdate = true\n    }\n  })\n\n  return (\n    <mesh position={[side, 0, positionZ]} rotation={[0, 0, 0]} ref={obstacleRef}>\n      <circleGeometry args={[0.6, 32]} />\n      <meshBasicMaterial map={textureRef.current} side={THREE.DoubleSide} />\n    </mesh>\n  )\n}\n\nconst Obstacles = React.forwardRef(({ mode, videos, setScore, hitPoints, setHitPoints, handleGameOver }, canaryRef) => {\n  const [obstacles, setObstacles] = useState([])\n  const [lastBonusToastId, setLastBonusToastId] = useState(null)\n  const [lastDamageToastId, setLastDamageToastId] = useState(null)\n\n  const visibleObstacles = 5\n  const clockRef = useRef({ elapsedTime: 0, delta: 0 })\n\n  const bonusRateRef = useRef(1)\n  const nearBonusDetected = useRef(false)\n  const collisionDetected = useRef(false)\n\n  const handleObstacleRef = (obstacleIdentifier, ref) => {\n    setObstacles(prevObstacles => {\n      return prevObstacles.map(obstacle => {\n        if (obstacle.z === obstacleIdentifier) {\n          if (ref.current) {\n            return { ...obstacle, ref }\n          }\n        }\n        return obstacle\n      })\n    })\n  }\n\n  useFrame(state => {\n    const { clock } = state\n    clockRef.current.delta = clock.getElapsedTime() - clockRef.current.elapsedTime\n\n    if (canaryRef && canaryRef.current) {\n      const playerBox = new Box3().setFromObject(canaryRef.current)\n      const bonusBox = new Box3().setFromObject(canaryRef.current)\n\n      // Transform the original bounding box to match the model inside\n      const scaleFactor = 1\n      const center = new THREE.Vector3()\n      const size = new THREE.Vector3()\n      playerBox.getCenter(center)\n      playerBox.getSize(size)\n\n      // Scale the size\n      size.multiplyScalar(scaleFactor)\n      const rotatedSize = new THREE.Vector3(size.x, size.z, size.y)\n      const scaledRotatedPlayerBox = new THREE.Box3()\n      scaledRotatedPlayerBox.setFromCenterAndSize(center, rotatedSize)\n\n      // Near bonus box\n      const bonusScaleFator = 1.35\n      const bonusZScaleFator = 1.75\n      const bonusCenter = new THREE.Vector3()\n      const bonusSize = new THREE.Vector3()\n      bonusBox.getCenter(bonusCenter)\n      bonusBox.getSize(bonusSize)\n      bonusSize.multiplyScalar(bonusScaleFator)\n      bonusSize.y *= bonusZScaleFator // y because it's rotated, but it's in fact z\n      const bonusRotatedSize = new THREE.Vector3(bonusSize.x, bonusSize.z, bonusSize.y)\n      const scaledRotatedBonusBox = new THREE.Box3()\n      scaledRotatedBonusBox.setFromCenterAndSize(bonusCenter, bonusRotatedSize)\n\n      let atLeastOneBonus = false\n      obstacles.forEach(obstacle => {\n        if (obstacle.ref && obstacle.ref.current) {\n          const obstacleBox = new Box3().setFromObject(obstacle.ref.current)\n          if (scaledRotatedPlayerBox && obstacleBox) {\n            collisionDetected.current = scaledRotatedPlayerBox.intersectsBox(obstacleBox)\n          }\n          if (scaledRotatedBonusBox && obstacleBox) {\n            nearBonusDetected.current = scaledRotatedBonusBox.intersectsBox(obstacleBox)\n          }\n        }\n\n        if (collisionDetected.current) {\n          setHitPoints(prevHitPoints => prevHitPoints - 5)\n\n          if (lastDamageToastId) {\n            toast.dismiss(lastDamageToastId)\n          }\n          const newToastId = toast.error('DAMAGE TAKEN', {\n            duration: 2500,\n            icon: '',\n            position: 'bottom-center',\n            style: {\n              borderRadius: '10px',\n              background: 'transparent',\n              color: '#fff',\n              fontWeight: 'bold'\n            }\n          })\n          setLastDamageToastId(newToastId)\n\n          if (hitPoints < 1) {\n            handleGameOver(true)\n          }\n          return\n        }\n\n        if (nearBonusDetected.current) {\n          atLeastOneBonus = true\n\n          if (bonusRateRef.current < 256) bonusRateRef.current *= 2\n\n          setScore(prevScore => prevScore + bonusRateRef.current)\n\n          if (lastBonusToastId) {\n            toast.dismiss(lastBonusToastId)\n          }\n          const newToastId = toast.success(`BONUS +${bonusRateRef.current}`, {\n            duration: 2500,\n            icon: '',\n            position: 'top-center',\n            style: {\n              borderRadius: '10px',\n              background: 'transparent',\n              color: '#fff',\n              fontWeight: 'bold'\n            }\n          })\n          setLastBonusToastId(newToastId)\n        }\n      })\n\n      if (!atLeastOneBonus) {\n        bonusRateRef.current = 1\n      }\n    }\n  })\n\n  const { scene } = useThree()\n\n  useFrame(state => {\n    const { clock } = state\n    clockRef.current.delta = clock.getElapsedTime() - clockRef.current.elapsedTime\n\n    if (canaryRef && canaryRef.current) {\n      // Move obstacles and clean up old ones\n      if (clockRef.current.delta >= 0.1) {\n        clockRef.current.elapsedTime = clock.getElapsedTime()\n        setObstacles(\n          prevObstacles =>\n            prevObstacles\n              .map(obstacle => ({\n                ...obstacle,\n                z: obstacle.z - 1\n              }))\n              .filter(obstacle => obstacle.z >= -10) // -10 is the screen limit\n        )\n        cleanUp(scene)\n      }\n\n      // Create new obstacles\n      if (obstacles.length < visibleObstacles) {\n        const lastObstacle = obstacles[obstacles.length - 1]\n        const lastPosition = lastObstacle ? lastObstacle.z : 0\n        const obstacleGap = random(10, 20)\n        const obstacleSide = Math.floor(Math.random() * 3) - 1\n\n        const newObstacle = {\n          id: Date.now() + Math.random(),\n          z: lastPosition + obstacleGap,\n          side: obstacleSide,\n          ref: null\n        }\n\n        setObstacles(prevObstacles => [...prevObstacles, newObstacle])\n      }\n    }\n  })\n\n  return (\n    <>\n      {obstacles.map(({ id, z, side }) => {\n        return (\n          <Obstacle\n            key={id}\n            mode={mode}\n            positionZ={z}\n            side={side}\n            videos={videos}\n            handleObstacleRef={handleObstacleRef}\n          />\n        )\n      })}\n    </>\n  )\n})\n\nexport { Obstacles }\n","import { useFrame, useThree } from '@react-three/fiber'\nimport React, { useState, useRef } from 'react'\nimport * as THREE from 'three'\nimport { cleanUp } from '../helpers/clean'\n\nconst SideSegment = React.forwardRef(({ positionZ, side }, ref) => {\n  const positionX = side === 'left' ? -1.5 : 1.5\n\n  return (\n    <mesh position={[positionX, 0, positionZ]} rotation={[Math.PI / 2, 0, 0]} ref={ref}>\n      <planeGeometry args={[0.1, 1000]} />\n      <meshBasicMaterial color={0xffffff} side={THREE.DoubleSide} />\n    </mesh>\n  )\n})\n\nconst PathSegment = React.forwardRef(({ positionZ }, ref) => {\n  return (\n    <mesh position={[0, -0.52, positionZ]} rotation={[Math.PI / 2, 0, 0]} ref={ref}>\n      <planeGeometry args={[0.1, 5]} />\n      <meshBasicMaterial color={0xffffff} side={THREE.DoubleSide} />\n    </mesh>\n  )\n})\n\nconst Path = React.forwardRef((_, playerRef) => {\n  const [segments, setSegments] = useState([])\n  const [gamePosition, setGamePosition] = useState(0)\n\n  const visibleSegments = 5\n  const lastSegmentRef = useRef()\n  const clockRef = useRef({ elapsedTime: 0, delta: 0 })\n\n  const { scene } = useThree()\n\n  useFrame(state => {\n    const { clock } = state\n    clockRef.current.delta = clock.getElapsedTime() - clockRef.current.elapsedTime\n\n    if (playerRef && playerRef.current) {\n      if (clockRef.current.delta >= 0.05) {\n        clockRef.current.elapsedTime = clock.getElapsedTime()\n        setGamePosition(gamePosition => gamePosition + 1)\n        setSegments(prevSegments => prevSegments.map(segment => segment - 1))\n      }\n\n      const lastSegmentZ = lastSegmentRef.current ? lastSegmentRef.current.position.z : 0\n\n      // Generate new segments if needed\n      if (segments.length < visibleSegments || gamePosition % visibleSegments > lastSegmentZ) {\n        const segmentGap = 20\n        const newSegmentZ = lastSegmentZ + segmentGap\n        setSegments(prevSegments => [...prevSegments, newSegmentZ])\n      }\n\n      // Remove segments that are far behind the player\n      if (segments.length > visibleSegments) {\n        setSegments(prevSegments => prevSegments.slice(1))\n        cleanUp(scene)\n      }\n    }\n  })\n\n  return (\n    <>\n      {segments.map((z, index) => (\n        <React.Fragment key={index}>\n          <PathSegment positionZ={z} ref={index === segments.length - 1 ? lastSegmentRef : undefined} />\n          <SideSegment positionZ={z} side=\"left\" />\n          <SideSegment positionZ={z} side=\"right\" />\n        </React.Fragment>\n      ))}\n    </>\n  )\n})\n\nexport { Path }\n","import { Html, OrbitControls } from '@react-three/drei'\nimport { EffectComposer, Glitch } from '@react-three/postprocessing'\nimport * as faceapi from 'face-api.js'\nimport { GlitchMode } from 'postprocessing'\nimport React, { useEffect, useRef, useState } from 'react'\nimport styled from 'styled-components'\nimport { GameOverScreen } from './GameOverScreen'\nimport { CameraController } from '../components/CameraController'\nimport { Canary } from '../components/Canary'\nimport { HealthBar } from '../components/HealthBar'\nimport { Lights } from '../components/Lights'\nimport { Noise } from '../components/Noise'\nimport { Obstacles } from '../components/Obstacles'\nimport { Path } from '../components/Path'\nimport { canaryConfig as config } from '../config'\nimport { playTrack } from '../helpers/track'\nimport { assetURL, prefix } from '../helpers/url'\n\nconst Game = ({ videos, models }) => {\n  const [canaryRef, setCanaryRef] = useState(null)\n  const [isGameOver, setIsGameOver] = useState(false)\n  const [score, setScore] = useState(0)\n  const [isGlitching, setIsGlitching] = useState(false)\n  const [mode, setMode] = useState('3D')\n  const [hitPoints, setHitPoints] = useState(100)\n\n  const handleCanaryRef = ref => {\n    if (ref.current) {\n      setCanaryRef(ref)\n    }\n  }\n\n  const handleGameOver = isGameOver => setIsGameOver(isGameOver)\n\n  useEffect(() => {\n    glitchAudioTrack.current = new Audio(assetURL('audio/glitch.mp3'))\n\n    const glitchOut = () => {\n      setIsGlitching(true)\n      playTrack(glitchAudioTrack)\n\n      setTimeout(() => {\n        setMode(prevMode => {\n          const newMode = prevMode === '2D' ? '3D' : '2D'\n\n          let randomDelay\n          if (newMode === '3D') {\n            randomDelay = 20000 + Math.random() * 10000\n          } else {\n            randomDelay = 2000 + Math.random() * 3000\n          }\n\n          setTimeout(glitchOut, randomDelay)\n\n          return newMode\n        })\n      }, 800)\n\n      setTimeout(() => {\n        setIsGlitching(false)\n      }, 1000)\n    }\n\n    const initialDelay = 20000 + Math.random() * 10000\n    const timeoutId = setTimeout(glitchOut, initialDelay)\n\n    return () => clearTimeout(timeoutId)\n  }, [])\n\n  useEffect(() => {\n    if (isGameOver) {\n      var id = window.setTimeout(function() {}, 0)\n\n      while (id--) {\n        window.clearTimeout(id)\n      }\n    }\n  }, [isGameOver])\n\n  useEffect(() => {\n    const loadModels = async () => {\n      Promise.all([\n        faceapi.nets.faceExpressionNet.loadFromUri(prefix('/models')),\n        faceapi.nets.faceRecognitionNet.loadFromUri(prefix('/models')),\n        faceapi.nets.ssdMobilenetv1.loadFromUri(prefix('/models')),\n        faceapi.nets.tinyFaceDetector.loadFromUri(prefix('/models')),\n        faceapi.nets.mtcnn.loadFromUri(prefix('/models')),\n        faceapi.nets.faceLandmark68Net.loadFromUri(prefix('/models')),\n        faceapi.nets.faceLandmark68TinyNet.loadFromUri(prefix('/models')),\n        faceapi.nets.ageGenderNet.loadFromUri(prefix('/models'))\n      ])\n    }\n    loadModels()\n  }, [])\n\n  const glitchAudioTrack = useRef(null)\n\n  let opacity = 0\n  let isGlitchActive = false\n\n  if (isGlitching) {\n    opacity = 0.5\n    isGlitchActive = true\n  }\n\n  const gameRef = useRef()\n\n  return isGameOver ? (\n    <GameOverScreen score={score} models={models} />\n  ) : (\n    <>\n      <CameraController mode={mode} />\n\n      <Lights config={config} />\n\n      <Path ref={canaryRef} />\n\n      <Obstacles\n        mode={mode}\n        videos={videos}\n        hitPoints={hitPoints}\n        setHitPoints={setHitPoints}\n        setScore={setScore}\n        handleGameOver={handleGameOver}\n        ref={canaryRef}\n      />\n\n      <Canary animation=\"walk\" speed={3} scale={config.model.scale} models={models} handleCanaryRef={handleCanaryRef} />\n\n      <Noise mode={mode} opacity={opacity} ref={gameRef} />\n\n      <EffectComposer>\n        <Glitch\n          dtSize={128}\n          mode={GlitchMode.SPORADIC}\n          delay={[0, 0]}\n          duration={[1000, 1000]}\n          active={isGlitchActive}\n        />\n      </EffectComposer>\n\n      <OrbitControls\n        minPolarAngle={Math.PI / 2.8}\n        maxPolarAngle={Math.PI / 1.8}\n        enableZoom={false}\n        enableRotate={false}\n      />\n\n      <Html fullscreen>\n        <ScoreContainer>\n          <ScoreDisplay>score: {score}</ScoreDisplay>\n          <HealthBar health={hitPoints} />\n        </ScoreContainer>\n      </Html>\n    </>\n  )\n}\n\nconst ScoreContainer = styled.div`\n  position: absolute;\n  top: 200px;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`\n\nconst ScoreDisplay = styled.h1`\n  color: #fff;\n  text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;\n`\n\nexport { Game }\n","import { Html, OrbitControls } from '@react-three/drei'\nimport * as faceapi from 'face-api.js'\nimport React, { useState, useEffect, useRef } from 'react'\nimport styled, { keyframes } from 'styled-components'\nimport { Game } from './Game'\nimport { Canary } from '../components/Canary'\nimport { Credits } from '../components/Credits'\nimport { Lights } from '../components/Lights'\nimport { canaryConfig as config } from '../config'\nimport { prefix } from '../helpers/url'\n\nconst StartScreen = ({ videos, models }) => {\n  const [showStartScreen, setShowStartScreen] = useState(true)\n  const [showSelectMode, setShowSelectedMode] = useState(true)\n  const videoRef = useRef()\n  const videoWidth = 320\n  const videoHeight = 240\n  const [captureVideo, setCaptureVideo] = useState(false)\n\n  const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0\n\n  useEffect(() => {\n    if (showSelectMode) {\n      return\n    }\n\n    const handleKeyPress = event => {\n      if (event.key === 'Enter') {\n        setShowStartScreen(false)\n      }\n    }\n\n    const handleTouch = event => {\n      if (event.type === 'touchstart') {\n        setShowStartScreen(false)\n      }\n    }\n\n    document.addEventListener('keydown', handleKeyPress)\n\n    if (isTouchDevice) {\n      document.addEventListener('touchstart', handleTouch)\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyPress)\n      if (isTouchDevice) {\n        document.addEventListener('touchstart', handleTouch)\n      }\n    }\n  }, [showSelectMode, setShowSelectedMode])\n\n  useEffect(() => {\n    const loadModels = async () => {\n      Promise.all([\n        faceapi.nets.faceExpressionNet.loadFromUri(prefix('/models')),\n        faceapi.nets.faceRecognitionNet.loadFromUri(prefix('/models')),\n        faceapi.nets.ssdMobilenetv1.loadFromUri(prefix('/models')),\n        faceapi.nets.tinyFaceDetector.loadFromUri(prefix('/models')),\n        faceapi.nets.mtcnn.loadFromUri(prefix('/models')),\n        faceapi.nets.faceLandmark68Net.loadFromUri(prefix('/models')),\n        faceapi.nets.faceLandmark68TinyNet.loadFromUri(prefix('/models')),\n        faceapi.nets.ageGenderNet.loadFromUri(prefix('/models'))\n      ])\n    }\n    loadModels()\n  }, [])\n\n  const handleGameMode = gameMode => {\n    if (gameMode === 'webcam') {\n      startVideo()\n    }\n    setShowSelectedMode(false)\n  }\n\n  function startVideo() {\n    setCaptureVideo(true)\n\n    navigator.mediaDevices\n      .getUserMedia({ video: { width: videoWidth } })\n      .then(stream => {\n        if (videoRef.current) {\n          let video = videoRef.current\n          video.srcObject = stream\n          video.play()\n        }\n      })\n      .catch(err => {\n        console.error(err)\n      })\n  }\n\n  function handleVideoOnPlay() {\n    setInterval(async () => {\n      if (videoRef) {\n        const detections = await faceapi\n          .detectSingleFace(videoRef.current, new faceapi.TinyFaceDetectorOptions())\n          .withFaceLandmarks()\n          .withFaceExpressions()\n        if (detections) {\n          if (detections.expressions.angry > 0.5) {\n            window.dispatchEvent(new KeyboardEvent('keydown', { key: 'ArrowLeft' }))\n          }\n\n          if (detections.expressions.surprised > 0.5) {\n            window.dispatchEvent(new KeyboardEvent('keydown', { key: 'ArrowRight' }))\n          }\n\n          if (detections.expressions.happy > 0.6) {\n            window.dispatchEvent(new KeyboardEvent('keydown', { key: 'ArrowUp' }))\n          }\n        }\n      }\n    }, 100)\n  }\n\n  return (\n    <>\n      {captureVideo && (\n        <Html fullscreen>\n          <div id=\"webcam_holder\">\n            <video id=\"webcam\" ref={videoRef} height={videoHeight} width={videoWidth} onPlay={handleVideoOnPlay} />\n            <p>\n              <span role=\"img\" aria-label=\"angry face\">\n                 (angry) to move left\n              </span>\n              <br />\n              <span role=\"img\" aria-label=\"surprised face\">\n                 (surprised) to move right\n              </span>\n              <br />\n              <span role=\"img\" aria-label=\"happy face\">\n                 (happy) to jump!\n              </span>\n            </p>\n          </div>\n        </Html>\n      )}\n\n      {showStartScreen ? (\n        <>\n          <Lights config={config} />\n\n          <Canary\n            animation={showSelectMode ? 'idle' : 'walk'}\n            speed={1}\n            position={[0, 0.2, 0]}\n            scale={config.model.scale}\n            models={models}\n            muted={showSelectMode ? true : false}\n          />\n\n          <OrbitControls minPolarAngle={Math.PI / 2.8} maxPolarAngle={Math.PI / 1.8} />\n\n          <Html fullscreen>\n            {showSelectMode ? (\n              <OverlayContainer>\n                <Title>canary in a meme mine</Title>\n                <Subtitle>select game mode:</Subtitle>\n                <ControllerOption onClick={() => handleGameMode('keyboard')}>\n                  <span role=\"img\" aria-label=\"keyboard\">\n                     keyboard\n                  </span>\n                </ControllerOption>\n                <ControllerOption onClick={() => handleGameMode('webcam')}>\n                  <span role=\"img\" aria-label=\"webcam\">\n                     webcam\n                  </span>\n                </ControllerOption>\n              </OverlayContainer>\n            ) : (\n              <OverlayContainer>\n                <Title>canary in a meme mine</Title>\n                <AnimatedSubtitle>get ready and press enter to start</AnimatedSubtitle>\n                <fieldset>\n                  <legend style={{ color: '#e6007a' }}>hint</legend>\n                  <Hint>the only way to score is by nearly avoiding collision with memes</Hint>\n                  <Hint>but be careful, you will lose health if you hit the memes</Hint>\n                  <Hint style={{ color: '#e6007a' }}>the closer you get, the more points you earn!</Hint>\n                </fieldset>\n              </OverlayContainer>\n            )}\n\n            <Credits />\n          </Html>\n        </>\n      ) : (\n        <Game videos={videos} models={models} />\n      )}\n    </>\n  )\n}\n\nconst blinkAnimation = keyframes`\n  0%, 100% { opacity: 1; }\n  50% { opacity: 0; }\n`\n\nconst OverlayContainer = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`\n\nconst Title = styled.h1`\n  margin: 0;\n  color: #fff;\n  text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;\n`\n\nconst Subtitle = styled.h2`\n  color: #fff;\n  margin-top: 300px;\n  margin-bottom: 5px;\n  text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;\n`\nconst Hint = styled.p`\n  color: #fff;\n  margin: 1px;\n  text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;\n  text-align: center;\n`\n\nconst AnimatedSubtitle = styled.h2`\n  color: #fff;\n  margin-top: 300px;\n  text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;\n  animation: ${blinkAnimation} 1500ms linear infinite;\n`\nconst ControllerOption = styled.h2`\n  margin: 5px;\n  color: #fff;\n  text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;\n  cursor: pointer;\n\n  &:hover {\n    color: #e6007a;\n  }\n`\n\nexport { StartScreen }\n","import React from 'react'\nimport styled from 'styled-components'\n\nconst ProgressBar = ({ progress }) => (\n  <ProgressBarContainer>\n    <Progress progress={progress} />\n  </ProgressBarContainer>\n)\n\nconst ProgressBarContainer = styled.div`\n  width: 25vw;\n  background-color: #ddd;\n  border: 2px solid #666;\n  border-radius: 20px;\n  overflow: hidden;\n`\n\nconst Progress = styled.div`\n  height: 20px;\n  width: ${props => props.progress}%;\n  background-color: #e6007a;\n  transition: width 0.5s ease-in-out;\n`\n\nexport { ProgressBar }\n","import { Preload } from '@react-three/drei'\nimport { Canvas } from '@react-three/fiber'\nimport React, { Suspense } from 'react'\nimport styled from 'styled-components'\nimport { StartScreen } from './StartScreen'\nimport { usePreloadedModels } from '../components/Models'\nimport { ProgressBar } from '../components/ProgressBar'\nimport { usePreloadedVideos } from '../components/Videos'\n\nconst Flow = () => {\n  const onCanvasCreated = ({ gl }) => {\n    const handleContextLost = event => {\n      event.preventDefault()\n      alert('WebGL context lost. Reloading the page for restoration...')\n      window.location.reload()\n    }\n\n    const canvas = gl.domElement\n\n    canvas.addEventListener('webglcontextlost', handleContextLost, false)\n\n    return () => {\n      canvas.removeEventListener('webglcontextlost', handleContextLost)\n    }\n  }\n\n  const numberOfModels = 3\n  const numberOfVideos = 32\n  const { models, modelsLoadingProgress } = usePreloadedModels(numberOfModels)\n  const { videos, videosLoadingProgress } = usePreloadedVideos(numberOfVideos)\n\n  if (models.length < numberOfModels) {\n    return (\n      <OverlayContainer>\n        <Title>loading 3D models ...</Title>\n        <ProgressBar progress={modelsLoadingProgress} />\n      </OverlayContainer>\n    )\n  }\n\n  if (videos.length < numberOfVideos) {\n    return (\n      <OverlayContainer>\n        <Title>loading memes...</Title>\n        <ProgressBar progress={videosLoadingProgress} />\n      </OverlayContainer>\n    )\n  }\n\n  return (\n    <Suspense fallback={null}>\n      <Canvas\n        shadows\n        dpr={[1, 2]}\n        camera={{ position: [3, 1, 3], fov: 50 }}\n        performance={{ min: 0.1 }}\n        onCreated={onCanvasCreated}\n      >\n        <Preload all />\n        <StartScreen videos={videos} models={models} />\n      </Canvas>\n    </Suspense>\n  )\n}\n\nconst OverlayContainer = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`\n\nconst Title = styled.h1`\n  margin: 0;\n  color: #fff;\n  text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;\n`\n\nexport { Flow }\n","import { useEffect, useState } from 'react'\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js'\nimport { assetURL } from '../helpers/url'\n\nfunction usePreloadedModels(numberOfModels) {\n  const [models, setModels] = useState([])\n  const [loadingProgress, setLoadingProgress] = useState(0)\n\n  useEffect(() => {\n    const loader = new GLTFLoader()\n    const cleanupFunctions = []\n    const selectedModels = ['walk', 'idle', 'hop']\n\n    let loadedModelsCount = 0\n\n    const modelObjects = selectedModels.map(name => {\n      const modelObj = { src: assetURL(`canary_${name}.glb`), loaded: false }\n\n      const onLoad = gltf => {\n        modelObj.gltf = gltf\n        modelObj.gltf.userData = { name }\n        modelObj.loaded = true\n        loadedModelsCount++\n        setLoadingProgress((loadedModelsCount / numberOfModels) * 100)\n\n        if (loadedModelsCount === numberOfModels) {\n          setModels(modelObjects.map(m => m.gltf))\n        }\n      }\n\n      const onError = error => {\n        console.error('Error loading model:', error)\n      }\n\n      loader.load(modelObj.src, onLoad, undefined, onError)\n\n      return modelObj\n    })\n\n    return () => {\n      cleanupFunctions.forEach(cleanup => cleanup())\n    }\n  }, [])\n\n  return { models, loadingProgress }\n}\n\nexport { usePreloadedModels }\n","import { useEffect, useState } from 'react'\nimport { assetURL } from '../helpers/url'\n\nfunction usePreloadedVideos(numberOfVideos) {\n  const [videos, setVideos] = useState([])\n  const [loadingProgress, setLoadingProgress] = useState(0)\n\n  useEffect(() => {\n    const cleanupFunctions = []\n    const selectedFilenames = []\n    const allFilenames = [\n      'monkey.mp4',\n      'good_job.mp4',\n      'wooow.mp4',\n      'really_girl.mp4',\n      'ooohh.mp4',\n      'cook.mp4',\n      'black_white_hihi.mp4',\n      'happy_face.mp4',\n      'marmot.mp4',\n      'nope.mp4',\n      'congrats.mp4',\n      'cat2.mp4',\n      'hiding_in_bush.mp4',\n      'blink_of_surprise.mp4',\n      'cat3.mp4',\n      'candy_cotton_girl.mp4',\n      'cat1.mp4',\n      'be_smart.mp4',\n      'hard_math.mp4',\n      'hurray_guy.mp4',\n      'gamer.mp4',\n      'disappointment.mp4',\n      'spongebob.mp4',\n      'omg_office.mp4',\n      'minion.mp4',\n      'how_to_play.mp4',\n      'trick_smile_girl.mp4',\n      'we_all_die.mp4',\n      'fire.mp4',\n      'confetti.mp4',\n      'high_five.mp4',\n      'girl_with_brush.mp4'\n    ]\n\n    for (let i = 0; i < numberOfVideos; i++) {\n      const randomIndex = Math.floor(Math.random() * allFilenames.length)\n      selectedFilenames.push(allFilenames[randomIndex])\n    }\n\n    const videoElements = selectedFilenames.map(filename => {\n      const videoObj = {\n        src: assetURL(`memes/${filename}`),\n        videoElement: document.createElement('video'),\n        loaded: false\n      }\n\n      const { videoElement } = videoObj\n      videoElement.src = videoObj.src\n      videoElement.preload = 'auto'\n      videoElement.muted = true\n      videoElement.loop = true\n      videoElement.playbackRate = 1.0\n      videoElement.setAttribute('playsinline', '')\n\n      const onCanPlayThrough = () => {\n        videoObj.loaded = true\n        const loadedVideosCount = videoElements.filter(v => v.loaded).length\n        setLoadingProgress((loadedVideosCount / numberOfVideos) * 100)\n\n        if (loadedVideosCount === numberOfVideos) {\n          setVideos(videoElements.map(v => v.videoElement))\n        }\n      }\n\n      videoElement.addEventListener('canplaythrough', onCanPlayThrough)\n      videoElement.load()\n\n      cleanupFunctions.push(() => videoElement.removeEventListener('canplaythrough', onCanPlayThrough))\n\n      return videoObj\n    })\n\n    return () => {\n      cleanupFunctions.forEach(cleanup => cleanup())\n    }\n  }, [numberOfVideos])\n\n  return { videos, loadingProgress }\n}\n\nexport { usePreloadedVideos }\n","import React, { StrictMode } from 'react'\nimport { createRoot } from 'react-dom/client'\nimport { Toaster } from 'react-hot-toast'\nimport styled from 'styled-components'\nimport { Flow } from './lib/Flow'\n\nimport './styles.css'\n\nconst StyledApp = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  height: 100%;\n`\n\nconst App = () => {\n  return (\n    <StyledApp>\n      <Toaster />\n      <Flow />\n    </StyledApp>\n  )\n}\n\nconst rootElement = document.getElementById('root')\nconst root = createRoot(rootElement)\nroot.render(\n  <StrictMode>\n    <App />\n  </StrictMode>\n)\n"],"sourceRoot":""}